FROM --platform=linux/amd64 node:18-slim 

WORKDIR /app

COPY package.json package-lock.json* ./
# Clean install if targeting different arch than host
RUN rm -rf node_modules && rm -f package-lock.json && npm install --include=optional

COPY . .

EXPOSE 8081
# This should match the start script in your analyze-position/package.json
CMD ["node", "gemini-server.js"] 
